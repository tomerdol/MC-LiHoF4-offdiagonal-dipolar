<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (16) on Tue Jul 13 14:10:33 IDT 2021 -->
<title>ewaldSum</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2021-07-13">
<meta name="description" content="declaration: package: utilities, class: ewaldSum">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
<script type="text/javascript" src="../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar.top">
<div class="skip-nav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.top.firstrow" class="nav-list" title="Navigation">
<li><a href="../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip.navbar.top">
<!--   -->
</span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">utilities</a></div>
<h1 title="Class ewaldSum" class="title">Class ewaldSum</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">utilities.ewaldSum</div>
</div>
<section class="description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">ewaldSum</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor.summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><span class="member-name-link"><a href="#%3Cinit%3E()">ewaldSum</a></span>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method.summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button><button id="method-summary-table-tab6" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab6', 3)" class="table-tab">Deprecated Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#calcEnergy(simulation.montecarlo.Lattice)">calcEnergy</a></span>&#8203;(<a href="../simulation/montecarlo/Lattice.html" title="class in simulation.montecarlo">Lattice</a>&nbsp;lattice)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Calculates the energy of the system</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double[]</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#calcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,double,int,int)">calcSum3D</a></span>&#8203;(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;realN_cutoff,
 int&nbsp;reciprocalN_cutoff)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Calls <a href="#calcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,double,int,int)"><code>calcSum3D(singleSpin, singleSpin, int, int, double, int, int)</code></a> with Lx=Ly as is often the case</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double[]</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#calcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int,double,int,int)">calcSum3D</a></span>&#8203;(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Ly,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;realN_cutoff,
 int&nbsp;reciprocalN_cutoff)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">The correct implementation of the Ewald summation method</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab6 method-summary-table-tab4 method-summary-table"><code>static double[]</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab6 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#calcSum3D2(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int,double,int,int)">calcSum3D2</a></span>&#8203;(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Ly,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;realN_cutoff,
 int&nbsp;reciprocalN_cutoff)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab6 method-summary-table-tab4 method-summary-table">
<div class="block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">use <a href="#calcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int,double,int,int)"><code>calcSum3D(singleSpin, singleSpin, int, int, int, double, int, int)</code></a></div>
</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#convergenceTests(simulation.montecarlo.singleSpin%5B%5D,int,int,double,int,int,int,int,double)">convergenceTests</a></span>&#8203;(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>[]&nbsp;arr,
 int&nbsp;Lz,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;N,
 int&nbsp;real_cutoff,
 int&nbsp;k_cutoff,
 int&nbsp;direct_cutoff,
 double&nbsp;ellipsoidRatio)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Convergence tests for initial verification of ewald summation in 3D.</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#convergenceTests2(int,int,int,int)">convergenceTests2</a></span>&#8203;(int&nbsp;Lz,
 int&nbsp;Lx,
 int&nbsp;real_cutoff,
 int&nbsp;max_k_cutoff)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">More advanced convergence tests than <a href="#convergenceTests(simulation.montecarlo.singleSpin%5B%5D,int,int,double,int,int,int,int,double)"><code>convergenceTests(singleSpin[], int, int, double, int, int, int, int, double)</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#convergenceTests3(int,int,int,int)">convergenceTests3</a></span>&#8203;(int&nbsp;Lz,
 int&nbsp;Lx,
 int&nbsp;real_cutoff,
 int&nbsp;k_cutoff)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Most advanced convergence tests.</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double[]</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#dipolarInteraction(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int)">dipolarInteraction</a></span>&#8203;(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Ly,
 int&nbsp;Lx)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Calculates the dipolar interaction between two spins naively implementing periodic boundary conditions</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static void</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#ellipsoidRadiiFill(double%5B%5D%5B%5D,double,double)">ellipsoidRadiiFill</a></span>&#8203;(double[][]&nbsp;arr,
 double&nbsp;c_max,
 double&nbsp;ellipsoidRatio)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Fills the given array with axes of 10 ellipsoids smaller than the one defined by <code>c_max</code></div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#fillIntTable(simulation.montecarlo.singleSpin%5B%5D,int,int,double,int,int,double%5B%5D%5B%5D%5B%5D)">fillIntTable</a></span>&#8203;(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>[]&nbsp;arr,
 int&nbsp;Lz,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;real_cutoff,
 int&nbsp;k_cutoff,
 double[][][]&nbsp;intTable)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Fills a given interactions table with dipolar interactions calculated using Ewald's method.</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#fillIntTable(simulation.montecarlo.singleSpin%5B%5D,int,int,double,int,int,java.io.BufferedWriter)">fillIntTable</a></span>&#8203;(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>[]&nbsp;arr,
 int&nbsp;Lz,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;real_cutoff,
 int&nbsp;k_cutoff,
 <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/io/BufferedWriter.html" title="class or interface in java.io" class="external-link">BufferedWriter</a>&nbsp;out)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Prints out the dipolar interactions calculated using Ewald's method.</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#main(java.lang.String%5B%5D)">main</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;args)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Create the tables of interaction using Ewald's method.</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static void</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#multipleSizeTestsWithvariableKcutoff(int%5B%5D,int,int%5B%5D)">multipleSizeTestsWithvariableKcutoff</a></span>&#8203;(int[]&nbsp;Lz,
 int&nbsp;real_cutoff,
 int[]&nbsp;k_cutoffs)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Print ewald convergence tests for multiple Lz's for analysis by the jupyter notebooks in /ewald_convergence</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#multipleSizeTestsWithvariableRealcutoff(int%5B%5D,int%5B%5D,int)">multipleSizeTestsWithvariableRealcutoff</a></span>&#8203;(int[]&nbsp;Lz,
 int[]&nbsp;real_cutoffs,
 int&nbsp;k_cutoff)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Print ewald convergence tests for multiple Lz's for analysis by the jupyter notebooks in /ewald_convergence</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#realCalcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int)">realCalcSum3D</a></span>&#8203;(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Lx,
 int&nbsp;N_cutoff)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Calculates the dipolar interaction between two spins using periodic boundary conditions
 and summing periodic copies of the lattice in cubes of size <code>N_cutoff</code>.</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double[][]</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#realCalcSum3DE(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int,double,double)">realCalcSum3DE</a></span>&#8203;(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Ly,
 int&nbsp;Lx,
 double&nbsp;c_max,
 double&nbsp;ellipsoidRatio)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Calculates the dipolar interaction between two spins using periodic boundary conditions
 and summing periodic copies of the lattice in ellipsoids of a given ratio and a given length
 of its c axis.</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static void</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#zeroArr(double%5B%5D%5B%5D)">zeroArr</a></span>&#8203;(double[][]&nbsp;arr)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Fills a <code>double</code> 2D array with zeros.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor.detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>ewaldSum</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">ewaldSum</span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method.detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="convergenceTests(simulation.montecarlo.singleSpin[],int,int,double,int,int,int,int,double)">
<h3>convergenceTests</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">convergenceTests</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>[]&nbsp;arr,
 int&nbsp;Lz,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;N,
 int&nbsp;real_cutoff,
 int&nbsp;k_cutoff,
 int&nbsp;direct_cutoff,
 double&nbsp;ellipsoidRatio)</span></div>
<div class="block">Convergence tests for initial verification of ewald summation in 3D. this compares ewald results with direct calculation</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>arr</code> - array of spins</dd>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>Lx</code> - number of unit cells in the x and y directions</dd>
<dd><code>alpha</code> - Ewald parameter</dd>
<dd><code>N</code> - total number of spins</dd>
<dd><code>real_cutoff</code> - cutoff in real space</dd>
<dd><code>k_cutoff</code> - cutoff in reciprocal space</dd>
<dd><code>direct_cutoff</code> - cutoff for direct calculation</dd>
<dd><code>ellipsoidRatio</code> - initial ratio of the ellipsoid which contains all unit cells included in the direct calculation</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="convergenceTests2(int,int,int,int)">
<h3>convergenceTests2</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">convergenceTests2</span>&#8203;<span class="parameters">(int&nbsp;Lz,
 int&nbsp;Lx,
 int&nbsp;real_cutoff,
 int&nbsp;max_k_cutoff)</span></div>
<div class="block">More advanced convergence tests than <a href="#convergenceTests(simulation.montecarlo.singleSpin%5B%5D,int,int,double,int,int,int,int,double)"><code>convergenceTests(singleSpin[], int, int, double, int, int, int, int, double)</code></a>.
 This is meant to find optimal values for alpha, real_cutoff, k_cutoff</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>Lx</code> - number of unit cells in the x and y directions</dd>
<dd><code>real_cutoff</code> - cutoff in real space</dd>
<dd><code>max_k_cutoff</code> - maximal cutoff in reciprocal space</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="convergenceTests3(int,int,int,int)">
<h3>convergenceTests3</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">convergenceTests3</span>&#8203;<span class="parameters">(int&nbsp;Lz,
 int&nbsp;Lx,
 int&nbsp;real_cutoff,
 int&nbsp;k_cutoff)</span></div>
<div class="block">Most advanced convergence tests.
 The output is used by the jupyter notebooks in /ewald_convergence when called by
 <a href="#multipleSizeTestsWithvariableKcutoff(int%5B%5D,int,int%5B%5D)"><code>multipleSizeTestsWithvariableKcutoff(int[], int, int[])</code></a> and <a href="#multipleSizeTestsWithvariableRealcutoff(int%5B%5D,int%5B%5D,int)"><code>multipleSizeTestsWithvariableRealcutoff(int[], int[], int)</code></a>.
 Meant to find optimal values for alpha, real_cutoff, k_cutoff</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>Lx</code> - number of unit cells in the x and y directions</dd>
<dd><code>real_cutoff</code> - cutoff in real space</dd>
<dd><code>k_cutoff</code> - cutoff in reciprocal space</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="multipleSizeTestsWithvariableKcutoff(int[],int,int[])">
<h3>multipleSizeTestsWithvariableKcutoff</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">multipleSizeTestsWithvariableKcutoff</span>&#8203;<span class="parameters">(int[]&nbsp;Lz,
 int&nbsp;real_cutoff,
 int[]&nbsp;k_cutoffs)</span></div>
<div class="block">Print ewald convergence tests for multiple Lz's for analysis by the jupyter notebooks in /ewald_convergence</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>real_cutoff</code> - constant real space cutoff</dd>
<dd><code>k_cutoffs</code> - array of reciprocal space cutoffs</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="multipleSizeTestsWithvariableRealcutoff(int[],int[],int)">
<h3>multipleSizeTestsWithvariableRealcutoff</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">multipleSizeTestsWithvariableRealcutoff</span>&#8203;<span class="parameters">(int[]&nbsp;Lz,
 int[]&nbsp;real_cutoffs,
 int&nbsp;k_cutoff)</span></div>
<div class="block">Print ewald convergence tests for multiple Lz's for analysis by the jupyter notebooks in /ewald_convergence</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>real_cutoffs</code> - array of real space cutoffs</dd>
<dd><code>k_cutoff</code> - constant reciprocal space cutoff</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="calcEnergy(simulation.montecarlo.Lattice)">
<h3>calcEnergy</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">calcEnergy</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/Lattice.html" title="class in simulation.montecarlo">Lattice</a>&nbsp;lattice)</span></div>
<div class="block">Calculates the energy of the system</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>lattice</code> - the lattice</dd>
<dt>Returns:</dt>
<dd>the energy of the lattice</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="main(java.lang.String[])">
<h3>main</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">main</span>&#8203;<span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;args)</span></div>
<div class="block">Create the tables of interaction using Ewald's method.
 Also used for testing the convergence with the given parameters when the
 appropriate lines are uncommented.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>args</code> - </dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="fillIntTable(simulation.montecarlo.singleSpin[],int,int,double,int,int,double[][][])">
<h3>fillIntTable</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">fillIntTable</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>[]&nbsp;arr,
 int&nbsp;Lz,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;real_cutoff,
 int&nbsp;k_cutoff,
 double[][][]&nbsp;intTable)</span></div>
<div class="block">Fills a given interactions table with dipolar interactions calculated using Ewald's method.
 This fills the interaction with the appropriate units and prefactor (hence it is not used for the simulation,
 where these are added separately)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>arr</code> - spin array</dd>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>Lx</code> - number of unit cells in the x and y directions</dd>
<dd><code>alpha</code> - Ewald parameter</dd>
<dd><code>real_cutoff</code> - real-space cutoff</dd>
<dd><code>k_cutoff</code> - reciprocal-space cutoff</dd>
<dd><code>intTable</code> - interactions tables to fill</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="fillIntTable(simulation.montecarlo.singleSpin[],int,int,double,int,int,java.io.BufferedWriter)">
<h3>fillIntTable</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">fillIntTable</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>[]&nbsp;arr,
 int&nbsp;Lz,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;real_cutoff,
 int&nbsp;k_cutoff,
 <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/io/BufferedWriter.html" title="class or interface in java.io" class="external-link">BufferedWriter</a>&nbsp;out)</span>
                         throws <span class="exceptions"><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></span></div>
<div class="block">Prints out the dipolar interactions calculated using Ewald's method.
 This fills the interaction with the bare dipolar interaction (it is the one used in the simulation)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>arr</code> - spin array</dd>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>Lx</code> - number of unit cells in the x and y directions</dd>
<dd><code>alpha</code> - Ewald parameter</dd>
<dd><code>real_cutoff</code> - real-space cutoff</dd>
<dd><code>k_cutoff</code> - reciprocal-space cutoff</dd>
<dd><code>out</code> - the output stream where the calc'd interactions are saved</dd>
<dt>Throws:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/io/IOException.html" title="class or interface in java.io" class="external-link">IOException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="calcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,double,int,int)">
<h3>calcSum3D</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double[]</span>&nbsp;<span class="element-name">calcSum3D</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;realN_cutoff,
 int&nbsp;reciprocalN_cutoff)</span></div>
<div class="block">Calls <a href="#calcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,double,int,int)"><code>calcSum3D(singleSpin, singleSpin, int, int, double, int, int)</code></a> with Lx=Ly as is often the case</div>
</section>
</li>
<li>
<section class="detail" id="calcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int,double,int,int)">
<h3>calcSum3D</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double[]</span>&nbsp;<span class="element-name">calcSum3D</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Ly,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;realN_cutoff,
 int&nbsp;reciprocalN_cutoff)</span></div>
<div class="block">The correct implementation of the Ewald summation method</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>i</code> - spin object <code>i</code></dd>
<dd><code>j</code> - spin object <code>j</code></dd>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>Ly</code> - number of unit cells in the y direction</dd>
<dd><code>Lx</code> - number of unit cells in the x direction</dd>
<dd><code>alpha</code> - Ewald parameter</dd>
<dd><code>realN_cutoff</code> - real space cutoff</dd>
<dd><code>reciprocalN_cutoff</code> - reciprocal space cutoff</dd>
<dt>Returns:</dt>
<dd>the zx, zy, zz interactions in a size 3 array: {zx, zy, zz}</dd>
<dt>See Also:</dt>
<dd><a href="http://arxiv.org/abs/0912.3469" target="_top">arXiv:0912.3469 [cond-mat] - Appendix C</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="calcSum3D2(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int,double,int,int)">
<h3>calcSum3D2</h3>
<div class="member-signature"><span class="annotations"><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Deprecated.html" title="class or interface in java.lang" class="external-link">@Deprecated</a>
</span><span class="modifiers">public static</span>&nbsp;<span class="return-type">double[]</span>&nbsp;<span class="element-name">calcSum3D2</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Ly,
 int&nbsp;Lx,
 double&nbsp;alpha,
 int&nbsp;realN_cutoff,
 int&nbsp;reciprocalN_cutoff)</span></div>
<div class="deprecation-block"><span class="deprecated-label">Deprecated.</span>
<div class="deprecation-comment">use <a href="#calcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int,double,int,int)"><code>calcSum3D(singleSpin, singleSpin, int, int, int, double, int, int)</code></a></div>
</div>
<div class="block">Calculates the dipolar interaction between two spins using the Ewald summation method.
 Works only for Orthorhombic, Tetragonal and Cubic crystal systems.</div>
</section>
</li>
<li>
<section class="detail" id="dipolarInteraction(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int)">
<h3>dipolarInteraction</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double[]</span>&nbsp;<span class="element-name">dipolarInteraction</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Ly,
 int&nbsp;Lx)</span></div>
<div class="block">Calculates the dipolar interaction between two spins naively implementing periodic boundary conditions</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>i</code> - spin object <code>i</code></dd>
<dd><code>j</code> - spin object <code>j</code></dd>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>Ly</code> - number of unit cells in the y direction</dd>
<dd><code>Lx</code> - number of unit cells in the x direction</dd>
<dt>Returns:</dt>
<dd>array containing 3 components of the dipolar interaction {xz,yz,zz}</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="realCalcSum3D(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int)">
<h3>realCalcSum3D</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">realCalcSum3D</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Lx,
 int&nbsp;N_cutoff)</span></div>
<div class="block">Calculates the dipolar interaction between two spins using periodic boundary conditions
 and summing periodic copies of the lattice in cubes of size <code>N_cutoff</code>.
 This is not the correct limiting shape without a demagnetization term.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>i</code> - spin object <code>i</code></dd>
<dd><code>j</code> - spin object <code>j</code></dd>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>Lx</code> - number of unit cells in the x and y direction</dd>
<dd><code>N_cutoff</code> - limiting size of the cube that includes copies of the lattice that are summed</dd>
<dt>Returns:</dt>
<dd>dipolar interaction between two spins with PBC</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="realCalcSum3DE(simulation.montecarlo.singleSpin,simulation.montecarlo.singleSpin,int,int,int,double,double)">
<h3>realCalcSum3DE</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double[][]</span>&nbsp;<span class="element-name">realCalcSum3DE</span>&#8203;<span class="parameters">(<a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;i,
 <a href="../simulation/montecarlo/singleSpin.html" title="class in simulation.montecarlo">singleSpin</a>&nbsp;j,
 int&nbsp;Lz,
 int&nbsp;Ly,
 int&nbsp;Lx,
 double&nbsp;c_max,
 double&nbsp;ellipsoidRatio)</span></div>
<div class="block">Calculates the dipolar interaction between two spins using periodic boundary conditions
 and summing periodic copies of the lattice in ellipsoids of a given ratio and a given length
 of its c axis.
 The limiting behavior of this calculation (with small ratios should mimic the Ewald method
 without a demagnetization term).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>i</code> - spin object <code>i</code></dd>
<dd><code>j</code> - spin object <code>j</code></dd>
<dd><code>Lz</code> - number of unit cells in the z direction</dd>
<dd><code>Lx</code> - number of unit cells in the x direction</dd>
<dd><code>Ly</code> - number of unit cells in the y direction</dd>
<dd><code>c_max</code> - length of the c-axis of the ellipsoid (the long axis, parallel to the magnetic easy axis of the system)</dd>
<dd><code>ellipsoidRatio</code> - the ratio between the ellipsoid's c and a and b axes.</dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="ellipsoidRadiiFill(double[][],double,double)">
<h3>ellipsoidRadiiFill</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">ellipsoidRadiiFill</span>&#8203;<span class="parameters">(double[][]&nbsp;arr,
 double&nbsp;c_max,
 double&nbsp;ellipsoidRatio)</span></div>
<div class="block">Fills the given array with axes of 10 ellipsoids smaller than the one defined by <code>c_max</code></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>arr</code> - array of ellipsoid radii to fill</dd>
<dd><code>c_max</code> - maximal c axis radius</dd>
<dd><code>ellipsoidRatio</code> - ratio between the c axis and the a and b axes.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="zeroArr(double[][])">
<h3>zeroArr</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">zeroArr</span>&#8203;<span class="parameters">(double[][]&nbsp;arr)</span></div>
<div class="block">Fills a <code>double</code> 2D array with zeros.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>arr</code> - array to fill w/ zeros</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
