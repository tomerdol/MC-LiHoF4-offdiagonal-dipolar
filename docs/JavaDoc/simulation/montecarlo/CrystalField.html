<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (16) on Tue Jul 13 14:10:33 IDT 2021 -->
<title>CrystalField</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2021-07-13">
<meta name="description" content="declaration: package: simulation.montecarlo, class: CrystalField">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../script.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar.top">
<div class="skip-nav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar.top.firstrow" class="nav-list" title="Navigation">
<li><a href="../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip.navbar.top">
<!--   -->
</span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">simulation.montecarlo</a></div>
<h1 title="Class CrystalField" class="title">Class CrystalField</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">simulation.montecarlo.CrystalField</div>
</div>
<section class="description">
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">CrystalField</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Builds and holds the crystal field Hamiltonian and given some (Bx,By,Bz) combination,
 adds a Zeeman term and diagonalizes to get eigenenergies and magnetic moments of the
 two lowest-energy levels.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field.summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>private static int</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#deg_J">deg_J</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">the degree of the angular momentum space; equals J*2 + 1</div>
</div>
<div class="col-first odd-row-color"><code>private static double</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#g_L">g_L</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">The Lande g-factor of the ion in question</div>
</div>
<div class="col-first even-row-color"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#H_cf">H_cf</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Crystal field Hamiltonian</div>
</div>
<div class="col-first odd-row-color"><code>private static double</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#hbar">hbar</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">reduced Planck constant; equals 1.0</div>
</div>
<div class="col-first even-row-color"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#I_J">I_J</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Identity matrix of dimension <code>deg_J</code></div>
</div>
<div class="col-first odd-row-color"><code>private static double</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#J">J</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">angular momentum of the ion</div>
</div>
<div class="col-first even-row-color"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#jminus">jminus</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">angular momentum matrices</div>
</div>
<div class="col-first odd-row-color"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#jplus">jplus</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">angular momentum matrices</div>
</div>
<div class="col-first even-row-color"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#jx">jx</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">angular momentum matrices</div>
</div>
<div class="col-first odd-row-color"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#jy">jy</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">angular momentum matrices</div>
</div>
<div class="col-first even-row-color"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#jz">jz</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">angular momentum matrices</div>
</div>
<div class="col-first odd-row-color"><code>private static org.ojalgo.matrix.store.PhysicalStore.Factory&lt;org.ojalgo.scalar.ComplexNumber,&#8203;org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;&gt;</code></div>
<div class="col-second odd-row-color"><code><span class="member-name-link"><a href="#storeFactory">storeFactory</a></span></code></div>
<div class="col-last odd-row-color">
<div class="block">ojAlgo matrix factory used to generate complex matrices</div>
</div>
<div class="col-first even-row-color"><code>private static double</code></div>
<div class="col-second even-row-color"><code><span class="member-name-link"><a href="#u_B">u_B</a></span></code></div>
<div class="col-last even-row-color">
<div class="block">Bohr's magneton in units of K/T; equals 0.6717</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor.summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><span class="member-name-link"><a href="#%3Cinit%3E()">CrystalField</a></span>()</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method.summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static int[]</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#findTwoLowestEnergies(org.ojalgo.array.Array1D)">findTwoLowestEnergies</a></span>&#8203;(org.ojalgo.array.Array1D&lt;org.ojalgo.scalar.ComplexNumber&gt;&nbsp;eigenvalues)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Finds the indices of the 2 lowest energy levels among the ones given.</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#getEnergy(double,double,double)">getEnergy</a></span>&#8203;(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Calculates the energy of a spin-up Holmium ion under crystal field potential and magnetic field (Bx,By,Bz).</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#getEnergy(double,double,double,int)">getEnergy</a></span>&#8203;(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz,
 int&nbsp;spin)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Calculates the energy of a Holmium ion under crystal field potential and magnetic field (Bx,By,Bz).</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#getMagneticMoment(double,double,double)">getMagneticMoment</a></span>&#8203;(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Calculates the magnetic moment of a spin-up Holmium ion under crystal field potential and magnetic field (Bx,By,Bz).</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static double</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#getMagneticMoment(double,double,double,int)">getMagneticMoment</a></span>&#8203;(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz,
 int&nbsp;spin)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Calculates the magnetic moment of a Holmium ion under crystal field potential and magnetic field (Bx,By,Bz).</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static org.ojalgo.matrix.decomposition.Eigenvalue&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#initDecomp(double,double,double)">initDecomp</a></span>&#8203;(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Initializes the eigenvalue decomposition object given (Bx,By,Bz)</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#initH_cfFe8()">initH_cfFe8</a></span>()</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Constructs the crystal field potential of the Fe8 system according to
 E.</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#initH_cfLiHoF4()">initH_cfLiHoF4</a></span>()</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Constructs the crystal field potential of LiHoF4 using the
 crystal field parameters derived and listed (in meV) in
 H.</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#initJminus()">initJminus</a></span>()</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Creates a J- angular momentum matrix</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#initJplus()">initJplus</a></span>()</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Creates a J+ angular momentum matrix</div>
</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#initJz()">initJz</a></span>()</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">Creates a J^z angular momentum matrix</div>
</div>
<div class="col-first odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>static void</code></div>
<div class="col-second odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#main(java.lang.String%5B%5D)">main</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;args)</code></div>
<div class="col-last odd-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">&nbsp;</div>
<div class="col-first even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code>private static org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</code></div>
<div class="col-second even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table"><code><span class="member-name-link"><a href="#power(org.ojalgo.matrix.store.GenericDenseStore,int)">power</a></span>&#8203;(org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;&nbsp;A,
 int&nbsp;n)</code></div>
<div class="col-last even-row-color method-summary-table-tab1 method-summary-table-tab4 method-summary-table">
<div class="block">matrix power (no special technique is used for this so it should not be used for very high powers)</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods.inherited.from.class.java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field.detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="hbar">
<h3>hbar</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">hbar</span></div>
<div class="block">reduced Planck constant; equals 1.0</div>
<dl class="notes">
<dt>See Also:</dt>
<dd><a href="../../constant-values.html#simulation.montecarlo.CrystalField.hbar">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="g_L">
<h3>g_L</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">g_L</span></div>
<div class="block">The Lande g-factor of the ion in question</div>
</section>
</li>
<li>
<section class="detail" id="u_B">
<h3>u_B</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">u_B</span></div>
<div class="block">Bohr's magneton in units of K/T; equals 0.6717</div>
<dl class="notes">
<dt>See Also:</dt>
<dd><a href="../../constant-values.html#simulation.montecarlo.CrystalField.u_B">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="J">
<h3>J</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">J</span></div>
<div class="block">angular momentum of the ion</div>
</section>
</li>
<li>
<section class="detail" id="deg_J">
<h3>deg_J</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">deg_J</span></div>
<div class="block">the degree of the angular momentum space; equals J*2 + 1</div>
</section>
</li>
<li>
<section class="detail" id="storeFactory">
<h3>storeFactory</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.PhysicalStore.Factory&lt;org.ojalgo.scalar.ComplexNumber,&#8203;org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;&gt;</span>&nbsp;<span class="element-name">storeFactory</span></div>
<div class="block">ojAlgo matrix factory used to generate complex matrices</div>
</section>
</li>
<li>
<section class="detail" id="H_cf">
<h3>H_cf</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">H_cf</span></div>
<div class="block">Crystal field Hamiltonian</div>
</section>
</li>
<li>
<section class="detail" id="jx">
<h3>jx</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">jx</span></div>
<div class="block">angular momentum matrices</div>
</section>
</li>
<li>
<section class="detail" id="jy">
<h3>jy</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">jy</span></div>
<div class="block">angular momentum matrices</div>
</section>
</li>
<li>
<section class="detail" id="jz">
<h3>jz</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">jz</span></div>
<div class="block">angular momentum matrices</div>
</section>
</li>
<li>
<section class="detail" id="jplus">
<h3>jplus</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">jplus</span></div>
<div class="block">angular momentum matrices</div>
</section>
</li>
<li>
<section class="detail" id="jminus">
<h3>jminus</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">jminus</span></div>
<div class="block">angular momentum matrices</div>
</section>
</li>
<li>
<section class="detail" id="I_J">
<h3>I_J</h3>
<div class="member-signature"><span class="modifiers">private static final</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">I_J</span></div>
<div class="block">Identity matrix of dimension <code>deg_J</code></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor.detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>CrystalField</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">CrystalField</span>()</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method.detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="initDecomp(double,double,double)">
<h3>initDecomp</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">org.ojalgo.matrix.decomposition.Eigenvalue&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">initDecomp</span>&#8203;<span class="parameters">(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz)</span></div>
<div class="block">Initializes the eigenvalue decomposition object given (Bx,By,Bz)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>Bx</code> - - magnetic field in the x direction</dd>
<dd><code>By</code> - - magnetic field in the y direction</dd>
<dd><code>Bz</code> - - magnetic field in the z direction</dd>
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="findTwoLowestEnergies(org.ojalgo.array.Array1D)">
<h3>findTwoLowestEnergies</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">int[]</span>&nbsp;<span class="element-name">findTwoLowestEnergies</span>&#8203;<span class="parameters">(org.ojalgo.array.Array1D&lt;org.ojalgo.scalar.ComplexNumber&gt;&nbsp;eigenvalues)</span></div>
<div class="block">Finds the indices of the 2 lowest energy levels among the ones given.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>eigenvalues</code> - - the list of eigenvalues (which could be complex, but only the real part is considered)</dd>
<dt>Returns:</dt>
<dd>a size-2 int array containing the indices of the lowest and second lowest eigenenergies (at places 0 and 1 respectively)</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMagneticMoment(double,double,double)">
<h3>getMagneticMoment</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">getMagneticMoment</span>&#8203;<span class="parameters">(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz)</span></div>
<div class="block">Calculates the magnetic moment of a spin-up Holmium ion under crystal field potential and magnetic field (Bx,By,Bz).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>Bx</code> - - magnetic field in the x direction</dd>
<dd><code>By</code> - - magnetic field in the y direction</dd>
<dd><code>Bz</code> - - magnetic field in the z direction</dd>
<dt>Returns:</dt>
<dd>Magnetic moment of the Ho ion under the given field and crystal field.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMagneticMoment(double,double,double,int)">
<h3>getMagneticMoment</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">getMagneticMoment</span>&#8203;<span class="parameters">(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz,
 int&nbsp;spin)</span></div>
<div class="block">Calculates the magnetic moment of a Holmium ion under crystal field potential and magnetic field (Bx,By,Bz).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>Bx</code> - - magnetic field in the x direction</dd>
<dd><code>By</code> - - magnetic field in the y direction</dd>
<dd><code>Bz</code> - - magnetic field in the z direction</dd>
<dd><code>spin</code> - spin direction (1 or -1)</dd>
<dt>Returns:</dt>
<dd>Magnetic moment of the Ho ion under the given field and crystal field.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getEnergy(double,double,double)">
<h3>getEnergy</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">getEnergy</span>&#8203;<span class="parameters">(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz)</span></div>
<div class="block">Calculates the energy of a spin-up Holmium ion under crystal field potential and magnetic field (Bx,By,Bz).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>Bx</code> - - magnetic field in the x direction</dd>
<dd><code>By</code> - - magnetic field in the y direction</dd>
<dd><code>Bz</code> - - magnetic field in the z direction</dd>
<dt>Returns:</dt>
<dd>Energy of the Ho ion under the given field and crystal field.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getEnergy(double,double,double,int)">
<h3>getEnergy</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">double</span>&nbsp;<span class="element-name">getEnergy</span>&#8203;<span class="parameters">(double&nbsp;Bx,
 double&nbsp;By,
 double&nbsp;Bz,
 int&nbsp;spin)</span></div>
<div class="block">Calculates the energy of a Holmium ion under crystal field potential and magnetic field (Bx,By,Bz).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>Bx</code> - - magnetic field in the x direction</dd>
<dd><code>By</code> - - magnetic field in the y direction</dd>
<dd><code>Bz</code> - - magnetic field in the z direction</dd>
<dd><code>spin</code> - spin direction (1 or -1)</dd>
<dt>Returns:</dt>
<dd>Energy of the Ho ion under the given field and crystal field.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="main(java.lang.String[])">
<h3>main</h3>
<div class="member-signature"><span class="modifiers">public static</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">main</span>&#8203;<span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/16/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]&nbsp;args)</span></div>
</section>
</li>
<li>
<section class="detail" id="power(org.ojalgo.matrix.store.GenericDenseStore,int)">
<h3>power</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">power</span>&#8203;<span class="parameters">(org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;&nbsp;A,
 int&nbsp;n)</span></div>
<div class="block">matrix power (no special technique is used for this so it should not be used for very high powers)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>A</code> - - matrix to raise to a power</dd>
<dd><code>n</code> - - the power to raise to</dd>
<dt>Returns:</dt>
<dd>A^n in a new instance of <code>GenericDenseStore&lt;ComplexNumber&gt;</code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initH_cfLiHoF4()">
<h3>initH_cfLiHoF4</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">initH_cfLiHoF4</span>()</div>
<div class="block">Constructs the crystal field potential of LiHoF4 using the
 crystal field parameters derived and listed (in meV) in
 H. M. Ronnow, J. Jensen, R. Parthasarathy, G. Aeppli, T. F. Rosenbaum, D. F. McMorrow,
 and C. Kraemer, Magnetic Excitations near the Quantum Phase Transition in the Ising Ferromagnet
 Li Ho F_4, Phys. Rev. B 75, 054426 (2007).
 Values in Kelvin are listed in Table I and details of the construction in appendix A of
 S. M. A. Tabei, M. J. P. Gingras, Y.-J. Kao, and T. Yavorsג€™kii,
 Perturbative Quantum Monte Carlo Study of LiHoF_4 in a Transverse Magnetic Field, Phys. Rev. B 78, 184408 (2008).</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the crystal-field Hamiltonian matrix</dd>
<dt>See Also:</dt>
<dd><a href="https://link.aps.org/doi/10.1103/PhysRevB.75.054426" target="_top">PhysRevB.75.054426</a>, 
<a href="https://link.aps.org/doi/10.1103/PhysRevB.78.184408" target="_top">PhysRevB.78.184408</a>, 
<a href="https://link.aps.org/doi/10.1103/PhysRevB.70.144411" target="_top">PhysRevB.70.144411</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initH_cfFe8()">
<h3>initH_cfFe8</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">initH_cfFe8</span>()</div>
<div class="block">Constructs the crystal field potential of the Fe8 system according to
 E. Burzurֳ­, F. Luis, B. Barbara, R. Ballou, E. Ressouche, O. Montero, J. Campo, and S. Maegawa,
 Magnetic Dipolar Ordering and Quantum Phase Transition in an Fe_8 Molecular Magnet, Phys. Rev. Lett. 107, 097203 (2011).</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the crystal-field Hamiltonian matrix</dd>
<dt>See Also:</dt>
<dd><a href="https://link.aps.org/doi/10.1103/PhysRevLett.107.097203" target="_top">PhysRevLett.107.097203</a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initJplus()">
<h3>initJplus</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">initJplus</span>()</div>
<div class="block">Creates a J+ angular momentum matrix</div>
</section>
</li>
<li>
<section class="detail" id="initJminus()">
<h3>initJminus</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">initJminus</span>()</div>
<div class="block">Creates a J- angular momentum matrix</div>
</section>
</li>
<li>
<section class="detail" id="initJz()">
<h3>initJz</h3>
<div class="member-signature"><span class="modifiers">private static</span>&nbsp;<span class="return-type">org.ojalgo.matrix.store.GenericDenseStore&lt;org.ojalgo.scalar.ComplexNumber&gt;</span>&nbsp;<span class="element-name">initJz</span>()</div>
<div class="block">Creates a J^z angular momentum matrix</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
